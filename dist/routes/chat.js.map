{"version":3,"sources":["../../src/routes/chat.js"],"names":["io","http","dotenv","config","router","express","Router","authenticateToken","req","res","next","token","cookies","redirect","jwt","verify","process","env","jwt_key","err","data","status","send","msg","user","get","console","log","decodeURIComponent","query","current_url","render","room","module","exports"],"mappings":";;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA,IAAMA,EAAE,GAAG,wBAAMC,gBAAN,CAAX;;AACAC,mBAAOC,MAAP;;AACA,IAAMC,MAAM,GAAGC,oBAAQC,MAAR,EAAf;;AAEA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC1C,MAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAY,UAAZ,CAAd;;AACA,MAAI,CAACD,KAAL,EAAY;AACV,WAAOF,GAAG,CAACI,QAAJ,CAAa,kBAAb,CAAP;AACD;;AACDC,2BAAIC,MAAJ,CAAWJ,KAAX,EAAkBK,OAAO,CAACC,GAAR,CAAYC,OAA9B,EAAuC,UAACC,GAAD,EAAMC,IAAN,EAAe;AACpD,QAAID,GAAJ,EAAS,OAAOV,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,MAAAA,GAAG,EAAE;AAAN,KAArB,CAAP;AACTf,IAAAA,GAAG,CAACgB,IAAJ,GAAWJ,IAAX;AACAV,IAAAA,IAAI;AACL,GAJD;AAKD,CAVH;AAYE;;;AACFN,MAAM,CAACqB,GAAP,CAAW,GAAX,EAAelB,iBAAf,EAAkC,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAClDgB,EAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BC,kBAAkB,CAACpB,GAAG,CAACqB,KAAJ,CAAUC,WAAX,CAA/C;AACArB,EAAAA,GAAG,CAACsB,MAAJ,CAAW,MAAX,EAAkB;AAACC,IAAAA,IAAI,EAAEJ,kBAAkB,CAACpB,GAAG,CAACqB,KAAJ,CAAUC,WAAX;AAAzB,GAAlB;AACC,CAHL;AAKEG,MAAM,CAACC,OAAP,GAAiB9B,MAAjB","sourcesContent":["import express from 'express';\r\nimport dotenv from 'dotenv';\r\nimport jwt from 'jsonwebtoken';\r\nimport http from 'http';\r\nimport ioLib from 'socket.io';\r\nconst io = ioLib(http);\r\ndotenv.config();\r\nconst router = express.Router();\r\n\r\nconst authenticateToken = (req, res, next) => {\r\n    const token = req.cookies['awtToken'];\r\n    if (!token) {\r\n      return res.redirect('/users/loginPage');\r\n    }\r\n    jwt.verify(token, process.env.jwt_key, (err, data) => {\r\n      if (err) return res.status(403).send({msg: 'Unauthorized Forbidden'});\r\n      req.user = data;\r\n      next();\r\n    });\r\n  };\r\n\r\n  /* GET chat page. */\r\nrouter.get('/',authenticateToken, (req, res, next) => {\r\n    console.log('chat url --> ', decodeURIComponent(req.query.current_url));\r\n    res.render('chat',{room: decodeURIComponent(req.query.current_url)});\r\n    });\r\n  \r\n  module.exports = router;"],"file":"chat.js"}